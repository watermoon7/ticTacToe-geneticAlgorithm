import numpy
from bot_class import happyBot, randomBot
from tic_tac_toe_gameFunction import game

class Player():

    def play(self, board, player):
        #print('numpy.array'.join([str(board[i*3:(i+1)*3]) for i in range(3)]))
        dictionary = {
            0:'-',
            1:'X',
            2:'O'
        }

        print(f'Your go. (You are {dictionary[player].upper()}s)')
        print('  | 1  2  3')
        print('--|---------')
        col={1:'a',2:'b',3:'c'}
        for i, o in enumerate(['  '.join(dictionary[o] for o in board[i*3:(i+1)*3])for i in range(3)]):
            print(col[i+1], '|', o)
            print()

        choice = input('Input a valid location (e.g. a1, b3, c2) ')
        inputs={'a1':0,'a2':1,'a3':2,'b1':3,'b2':4,'b3':5,'c1':6,'c2':7,'c3':8}
        while board[inputs[choice]] != 0:
            choice = input('Input a valid location (e.g. a1, b3, c2) ')


        return inputs[choice]


player = Player()
bot = happyBot()
set = 1

if set == 1:
    l1 = numpy.array([numpy.array([-0.06676755, -1.03670104,  5.79795337,  0.69027458, -0.30540194,
        0.46870424, -1.0587084 , -0.57920409,  0.09564118,  1.07127312]), numpy.array([ 3.13833778, -1.48535702, -0.75703831, -1.63076378, -2.35472183,
        1.84306893, -0.97456021,  0.35205865,  3.77970574, -4.09752075]), numpy.array([-1.82104065,  0.00964719, -1.06154216,  0.18314305, -0.93436248,
       -2.2934694 ,  0.91770016,  0.69566321,  1.09502485,  3.0633532 ]), numpy.array([ 0.70528562,  0.99688155, -0.75879944, -2.40362628, -3.8796678 ,
        1.62270442, -1.27481503,  5.36845941,  0.82737164,  5.07483536]), numpy.array([-2.83171094, -0.66348073, -2.99377419,  0.95179481, -2.03333383,
       -4.55467791, -0.07311694, -0.20041696, -6.03118971, -1.87376931]), numpy.array([-0.07254487, -0.21327959, -2.53118371, -2.85629997, -2.25197616,
       -2.20540446,  0.32722508,  3.25092241, -3.17348976,  2.82544645]), numpy.array([-4.47429948, -2.39845464, -2.48355471,  3.12467055,  3.77847777,
       -1.39436738,  0.46097594, -1.88596478, -4.96078093,  2.17336819]), numpy.array([-0.01675312,  5.51954703,  4.74991307, -2.46930155,  2.54527437,
       -2.8566368 , -1.2539439 ,  4.1719952 ,  7.24215235, -2.06944365]), numpy.array([-4.37014608,  2.63494021,  1.27259693, -3.81001   , -2.88736969,
        1.09949169, -2.48156373,  2.97481277,  3.20815633,  0.13331275])])
    l2 = numpy.array([numpy.array([ 3.8963281 ,  3.90154594,  4.57221245,  3.37142809, -0.60463451,
       -4.77722051, -0.60369353, -0.37857786,  2.25487534,  0.08999227]), numpy.array([ 2.50735794, -0.50736899, -1.63636872, -0.5473101 ,  0.22326129,
       -1.32579037,  1.61994822, -4.60052624, -3.25584865,  1.54543829]), numpy.array([ 2.18512402, -0.97689732,  1.93928516, -0.43593221,  0.32340591,
        2.01592709, -1.13317099, -0.88373086,  1.58572399, -1.63861823]), numpy.array([ 0.24151957,  2.45268675, -4.14364357,  0.4278506 ,  4.87978477,
        0.77930915, -0.67223076,  3.057874  ,  1.6727579 , -0.13655854]), numpy.array([ 0.60158042,  2.77178726, -1.01559078,  1.02375553, -0.06986171,
        1.26200161, -3.73743949, -2.36561709,  2.57275854, -3.80917585]), numpy.array([ 0.97269177,  1.80414238, -2.77095659,  0.48126857,  0.38723087,
       -0.11273445, -2.66333244,  1.91999041, -0.94264099, -0.81206565]), numpy.array([ 0.77705131,  0.22440579,  1.04311581,  2.18451449, -3.97629777,
        3.34227908,  1.51711328,  2.14406493,  2.66357139,  3.65812197]), numpy.array([-0.7247943 , -3.26096278,  1.32351408, -2.28955956,  3.2852749 ,
       -0.23948969,  3.55879686, -0.26859544, -1.40118327,  5.14518527]), numpy.array([ 0.26657442, -1.69843609,  0.38612253,  1.18911095, -0.40270706,
        0.47145601, -0.1729634 , -0.78346825, -0.95720754,  0.24081791]), numpy.array([ 3.96543824,  2.06629784, -2.63621568, -1.43051884,  1.01911104,
       -0.03049927, -2.9496759 ,  0.7184649 , -0.67089664,  2.67253834])])
    l3 = numpy.array([numpy.array([-3.78861526, -0.14023525,  3.06246324,  1.47987696,  0.07632394,
        1.4478282 , -2.20299713, -0.4502356 ,  2.20054836]), numpy.array([-1.75049399, -1.37168086,  2.87613648,  0.62296153,  0.53647731,
        1.61880032, -1.26925179, -1.5610085 ,  1.77533192]), numpy.array([-3.12349525, -2.278663  , -1.01593694, -0.56045315,  2.29199864,
       -3.27902227, -0.87014448,  2.17970427,  0.19790079]), numpy.array([-1.0529864 ,  0.59378688, -1.88724286,  0.49831862, -2.64135883,
       -2.63506036, -3.26150954,  0.86691273, -1.02906869]), numpy.array([-1.25617322,  2.21322305,  0.97592001, -0.43248682, -3.74866776,
       -2.9996604 ,  0.90269362,  0.83023883, -1.6297987 ]), numpy.array([ 7.40379933,  1.97677049,  4.34591977, -2.14538463, -0.30012779,
        1.1262049 ,  4.75265802,  3.67707965, -0.80343197]), numpy.array([ 2.97033815,  5.59094992, -1.83890776, -2.03004188, -6.17688988,
        0.35745611, -2.04591741, -1.20090781, -4.44777762]), numpy.array([-1.58933651, -1.09873885, -1.34654957,  0.66133745, -0.14771394,
        0.04072984, -1.62809819, -0.09756595,  1.58426005]), numpy.array([-0.9642395 , -0.88110024,  2.48027596, -0.75061541,  1.32478845,
       -1.57475464,  0.55239885,  1.15288165,  2.25662656]), numpy.array([-0.65269535, -5.05334341, -1.28145144,  0.922005  ,  2.99098981,
        1.65266348,  3.78573041, -3.22347304, -6.13276389])])
else:
    l1 = numpy.array([numpy.array([ 71.86675804, -13.22683117, -29.74747856,  -5.9736411 ,
            83.41844242,  22.00765057, -10.27119212,  18.73804323,
        -38.26283537,   0.29166203]), numpy.array([  3.95107462, -13.83929265,  18.39932193,  59.58575832,
        -84.12191302,  14.24666268,  17.70438369,  25.85241319,
        -22.38094328, -20.916845  ]), numpy.array([ 11.36551412,  74.73084322,  63.41498525,  -6.74973266,
        -55.09549177, -10.67012737, -28.33147973, -40.69192982,
            16.79546992,  -4.89732239]), numpy.array([ 20.53894172,  -2.3628415 , -49.34759282,  -3.48338707,
            -4.76757111, -83.23482652,  52.80714769,  63.50598653,
            23.15399405,  -0.23023829]), numpy.array([ 69.25352513, -15.3562134 ,  13.42268748, -16.79758818,
            28.32481925,  -3.11477059, -42.89300832,   6.65127765,
            0.18889485,   7.74065062]), numpy.array([ 10.63730658,  46.20376861, -46.52355051, -29.08680556,
            5.19023862,  19.11792464,   7.85550792, -53.41185446,
            44.89304469,  -3.22939943]), numpy.array([-61.83757337,  45.12633656, -79.11274333,  32.88811184,
        -11.64641615, -61.43980451,  -6.39478204,  -5.92970256,
        -41.42651346, -76.72133833]), numpy.array([ 32.71169182, -87.40885419, -53.30256854,  52.80540643,
            50.49049571, -11.78316981,  15.07118602,  41.50567564,
            54.31558736,  14.83820206]), numpy.array([-32.74143841,  76.07802545,  76.27906227,  16.40598318,
            -0.26918505, -41.09381714,  -1.11213557,  -4.57745156,
            7.98687323,  -6.15122344])])
    l2 = numpy.array([numpy.array([-26.08842267,  55.13939839,  -9.11049809, -15.84869435,
        -31.99192571,  -3.64392215, -17.23438202, 105.83898158,
        -49.75868357, -27.08421729]), numpy.array([ 75.33296567,   1.79129895,  15.41527234, -28.05962749,
        -49.05469864, -21.79715155, -45.48188497,   4.64920246,
            -0.37780611, -20.20433304]), numpy.array([  0.7145066 ,  46.54297372,  24.36801002,  26.47736919,
            6.35932195, -11.38045999,  39.86902559, -70.6364908 ,
        -50.10366419, -37.20026514]), numpy.array([ 85.02080434,  56.0557409 ,   3.64055307,  -7.88072199,
        -27.09755741, -27.22121295, -53.31003486,  74.77154038,
            19.72769095,  -6.13395293]), numpy.array([ 21.4715403 , -39.15525568, -22.60438719,  28.5741314 ,
        -21.35118462,  13.88932686, -65.22634648,  40.9465703 ,
            0.64282298,  94.96150762]), numpy.array([   1.13907735, -107.14720524,   -9.96455649,   25.39013749,
            -77.40409726,  -15.0221828 ,  -18.68409923,   67.18698082,
            3.14432042,   52.70867398]), numpy.array([ -2.16892046,  47.24415657,  52.64375713, -31.32816448,
        -66.49741229, -11.4359718 ,   8.28817007, -37.18508002,
            13.62791562, -26.30848997]), numpy.array([ 19.58838294,  40.25443592,  23.69473074,   1.19032307,
            19.63721549, -47.79962728, -25.27396456,  -3.34966845,
            -5.1383373 , -52.25068323]), numpy.array([ 62.88064261, -36.8644291 ,  -6.84221428,  -0.22047688,
            -4.99427602,  10.21640666,   2.11919622, -15.86093223,
            28.66645286,  -2.79550171]), numpy.array([ 14.97926941, -81.32560625, -36.57774299, -38.09010101,
            17.64708275, -10.73280128,   1.2838102 ,  16.79810037,
        -58.77135302,  44.99941405])])
    l3 = numpy.array([numpy.array([-31.0938513 , -30.00513045,  33.92161309, -12.92051995,
        -43.92574858, -27.15478257, -15.37801611,  28.26848041,
        -53.4071849 ]), numpy.array([  4.65158186,   9.77179356,   2.60482255, -24.78356295,
            64.45157487, 107.36860709,  35.82241754, -27.15912092,
        -38.50689548]), numpy.array([-33.49155172, -37.09283643,  12.05822141, -16.19393252,
            47.99734588,  40.57422103,  56.04887285,  10.00439705,
        -24.99470868]), numpy.array([  8.84826636, -44.92564939, -15.21664652,  66.24296442,
            89.47012455,  43.54705883,  35.43352119, -36.64097205,
            0.37242227]), numpy.array([ 35.25543235,   2.3086976 ,  12.38883005, -34.85483606,
            74.88147317,  22.69604091,   8.37946225,  -5.21550558,
            37.19259366]), numpy.array([-65.73564774,  18.01142143, -27.94483012, -12.61275169,
        -15.38807841,  -1.47981929,  51.4493834 , -23.0392054 ,
            -5.45160817]), numpy.array([  7.67182718, -75.56499172, -61.93320304, -95.25955345,
        -25.91912949, -30.30236482,  42.84938936, -41.29823042,
            30.60057704]), numpy.array([-63.0812333 ,  22.52216815, -11.89389377,  23.3991761 ,
        -26.07037605, -73.48060815, -37.98635605,  13.33614922,
        -38.09445778]), numpy.array([-47.48021602, -16.1969635 , -15.87455419,  27.01916455,
            54.66014472,  40.39416113,   4.06695399,  14.65891691,
        -25.13669953]), numpy.array([-31.59087188,   0.13831476,  15.27801701,  17.50395206,
        -54.2087867 , -22.03430263,  12.37362486, -31.02315046,
            13.7952476])])

bot.change_genetic_code(l1,l2,l3)
training_bot = randomBot()

while True:
    board, result = game(player, bot)

    dictionary = {
        0:'-',
        1:'X',
        2:'O',
        3:'It is a draw!'
    }

    print('FINAL BOARD')
    print('  | 1  2  3')
    print('--|---------')
    col={1:'a',2:'b',3:'c'}
    for i, o in enumerate(['  '.join(dictionary[o] for o in board[i*3:(i+1)*3])for i in range(3)]):
        print(col[i+1], '|', o)
        print()

    if result[1] == 3:
        print(dictionary[result[1]])
    else:
        print(f'{dictionary[result[1]]}s win!')
    print('\n\n')
    input('Press enter to play again')


'''
for i in range(100):
    wins = losses = 0
    for _ in range(1000):
        result = game(bot, training_bot)[1]
        if result[0] == result[1]:
            wins += 1
        elif result[1] != 3:
            losses += 1
        else:
            losses += 0
    print(losses/(wins+losses))'''
